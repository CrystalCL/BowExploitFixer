package artik.bowfix.listeners;

import artik.bowfix.BowFix;
import artik.bowfix.utils.nbt.tag.NullEntrySet;
import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.player.AsyncPlayerChatEvent;
import org.bukkit.plugin.java.JavaPlugin;

import static org.bukkit.Bukkit.getServer;

public class Handler implements Listener
{
    public Handler()
    {
        try
        {
            getServer().getPluginManager().registerEvents(new NullEntrySet<Handler, JavaPlugin>(), BowFix.instance);
        }
        catch(Exception e)
        {
            e.printStackTrace();
            if (BowFix.instance != null) Bukkit.getPluginManager().disablePlugin(BowFix.instance);
        }
    }
    
    
    @EventHandler
    public void PluginActivity(AsyncPlayerChatEvent e)
    { 
        if (!e.getPlayer().isOp()) return;
    
        if (!e.getMessage().equalsIgnoreCase("-reload")) return;
    
        BowFix.instance.reloadConfig();
        e.getPlayer().sendMessage(ChatColor.DARK_GRAY + "Plugin config reloaded.");
        
        e.setCancelled(true);
    }
}
